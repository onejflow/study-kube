# Pod

- 논리적 단위의 그룹화 -> 컨테이너들을 효과적으로 관리하고 조정하기 위해, 관련 컨테이너들을 하나의 그룹, 즉 "파드(Pod)"라는 단위로 묶는 것을 의미함. 
- 파드는 쿠버네티스에서 생성 및 관리되는 가 장 작은 배포 단위이며, 일반적으로 서로 긴밀하게 협력하는 컨테이너들로 구성 

1. 공유 리소스와 통신
    - 파드 안에 있는 컨테이너들은 같은 네트워크 네임스페이스와 스토리지를 공유할 수 있음. 이는 컨테이너들이 서로 통신하기 용이하게 하며, 필요한 데이터를 서로 쉽게 접근할 수 있게 해줌. 
2. 컨테이너 조정
    - 파드를 사용하면, 관련된 여러 컨테이너들을 한 그룹으로 관리할 수 있음. 이는 배포, 스케일링 및 관 리를 간소화함. 예를 들어, 하나의 파드에 포함된 컨테이너들은 함께 시작되고 종료되며, 동일한 하드웨어 리소스를 공유함. 
3. 서비스 디스커버리
    - 파드는 하나의 로지컬 호스트로 취급됨으로써, 하나의 IP 주소와 포트 범위를 가짐. 이는 네트워 크를 통한 서비스 발견과 라우팅을 단순화함. 
4. 부하 분산과 자동 복구
    -  쿠버네티스는 파드를 여러 노드에 걸쳐 자동으로 배포할 수 있으며, 파드가 실패할 경우 자 동으로 복구(재시작)할 수 있음. 이를 통해 애플리케이션의 가용성과 내구성이 향상됨.

## Container

파드 안에서는 하나의 독립적인 서비스를 구성할 수 있는 컨테이너들이 있음
- 한 파드 내에서 컨테이너들끼리 포트가 중복될 수 없음 (Container 간에 같은 Port를 노출시키면 Pod 생성시 충돌 에러 발생)
- pod 생성 시 고유의 ip 주소가 할당. 쿠버네티스 클러스터 내에서만 접근 가능, 재생성시 변경되는 ip
- Pod 내부의 Container끼리는 localhost로 Port만 지정해서 호출 가능

## Label 
사용목적에 따라 label 등록, 추후 service 라는것을 만들 때, 해당 라벨이 붙어 있는 파드에 연결 가능

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: pod-2
  labels:
    type: web
    io: dev 
```

```yaml
apiVersion: v1
kind: Service
metadata:
  name: svc-1
spec:
  selector:
    type: web
  ports:
    - port: 8080

```


## Node Schedule
pod는 여러 노드들 중에 하나에 올라가야함

1. 직접선택하는 방법
    - nodeSelector 항목에 노드에 라벨과 매칭되는 key,value 넣기
    ```yaml
    apiVersion: v1
    kind: Pod
    metadata:
      name: pod-3
    spec:
      nodeSelector:
        hostname: node1
      containers:
      - name: container
        image: 
    ```

2. 자동으로 지정해주는 방법(스케줄러가 판단)
    - 노드에는 사용가능한 자원량이 있음
    - 사용량을 넣는 경우 스케줄러가 판단
    - 사용량을 명시하지 않고 스케줄러가 넣었을때 자원을 넘기는 경우 memory에 경우 pod를 종료, cpu에 겅우 초과가 되지 않도록 해줌

    ```yaml
    apiVersion: v1
    ...
    spec:
      containers:
      - name: container
        image: tmkube/init
        resources:
          requests:
            memory: 2Gi
          limits:
            memory: 3Gi
    ```


# Namespace, ResourceQuata, LimitRange

쿠버네티스 클러스터에서 Namespace, ResourceQuota, LimitRange는 다수의 사용자나 팀이 하나의 클러스터를 공유할 때 자원을 효율적으로 격리하고 관리하기 위한 핵심 기능
- Namespace는 논리적인 공간을 나누고,
- ResourceQuota는 그 공간의 총 자원량을 제한하며, 
- LimitRange는 개별 파드(Pod)가 사용할 수 있는 자원의 범위를 제어

| 개념            | 역할 및 정의                                               | 필요한 이유 (Why)                                      | 적용 범위              |
| ------------- | ----------------------------------------------------- | ------------------------------------------------- | ------------------ |
| Namespace     | 클러스터를 논리적으로 나누는 가상 격리 공간 velog​                       | 팀/환경(Dev/Prod) 간 리소스 충돌 방지 및 권한 분리        | 클러스터 전체            |
| ResourceQuota | Namespace 전체가 사용할 수 있는 자원 총량 제한​ | 특정 팀의 자원 독점 방지 및 공정한 자원 할당 보장 ​ | Namespace (집계 단위)  |
| LimitRange    | 개별 Pod/Container의 자원 할당량(최소/최대) 제어              | 비정상적인 크기의 Pod 생성 차단 및 자원 설정 누락 시 기본값 자동 적용        | Namespace 내 개별 리소스 |

# Namespace 
- Namespace는 App(pod+service)간에 논리적인 구분을 하기 위해 그룹과 같은 개념으로 사용
- Namespace 내에서 같은 종류의 Object는 이름이 동일할 수 없음 (다른 네임스페이스에선 가능)
- Service의 Selector로 Pod를 연결시 같은 Namespace 상에서만 연결 가능
- Pod간의 네트워크 통신이나, Node를 이용한 Volume은 Namespace가 서로 다르더라도 연결 및 공유 가능

즉, 네트워크,노드,클러스터 범위 리소스 격리는 하지 않고 공유됨
- 네임스페이스 별로 똑같은 포트 설정못함 하나에서 3000포트 쓰면 다른곳에서 못씀

```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: nm-1
```

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: pod-1
  namespace: nm-1
  labels:
    app: pod
spec:
  containers:
  - name: container
    image: kubetm/app
    ports:
    - containerPort: 8080
```

```yaml
apiVersion: v1
kind: Service
metadata:
  name: svc-1
  namespace: nm-1
spec:
  selector:
    app: pod
  ports:
  - port: 9000
    targetPort: 8080
```

# ResourceQuota
- Cluster나 Namespace별 자원사용량을 제한시키 위해 사용 (실무에서는 관리가 힘들어서 잘 사용되진 않는다고 한다)

- 특정 Namespace에서 ResourceQuota 설정시 해당 Namespace에 만들어지는 Pod에 Resource 설정 필수

- ResourceQuota로 제한되는 항목은 Docs 확인 필요

```yaml
apiVersion: v1
kind: ResourceQuota
metadata:
  name: rq-1
  namespace: nm-3
spec:
  hard:
    requests.memory: 1Gi
    limits.memory: 1Gi
```